!function(e){"use strict";redux.field_objects=redux.field_objects||{},redux.field_objects.typography=redux.field_objects.typography||{};var t=[],s=!1,r={width:"100%",allowClear:!0,theme:"classic"};e(document).ready(function(){}),redux.field_objects.typography.init=function(i,a){i||(i=e(document).find(".redux-group-tab:visible").find(".redux-container-typography:visible")),e(i).each(function(){var i=e(this),a=i;if(i.hasClass("redux-field-container")||(a=i.parents(".redux-field-container:first")),!a.is(":hidden")&&a.hasClass("redux-field-init")){a.removeClass("redux-field-init");var l;i.each(function(){e(this).find(".redux-typography-container").each(function(){var a=e(this).find(".redux-typography-family");void 0===a.attr("data-value")?a=e(this):""!==a.attr("data-value")&&e(a).val(a.attr("data-value")).trigger("change");var o=e(this).find(".select2_params");if(o.size()>0){var d=o.val();d=JSON.parse(d),r=e.extend({},r,d)}l=Boolean(e(this).find(".redux-font-clear").val());var n=[{id:"none",text:"none"}],p=e(this).find(".redux-typography-family").parents(".redux-container-typography:first").attr("data-id"),c=e("#"+p+" .redux-typography-font-family").data("user-fonts");c=c?1:0;var u=e("#"+p+" .redux-typography-google").val();u=u?1:0;var h=[];if(void 0!==redux.customfonts&&h.push(redux.customfonts),void 0!==redux.stdfonts&&0===c&&h.push(redux.stdfonts),1==c){var f=[];for(var y in redux.typography[p]){var g=redux.typography[p].std_font;for(var x in g)g.hasOwnProperty(x)&&f.push({id:x,text:x,"data-google":"false"})}var v={text:"Standard Fonts",children:f};h.push(v)}(1==u||u===!0&&void 0!==redux.googlefonts)&&h.push(redux.googlefonts),n=h;var b,m;b=r,m=e(this).find(".redux-typography-family").attr("placeholder");var _=e(this).find(".redux-typography-family").attr("data-value");b.data=n,b.placeholder=m,b.allowClear=l,e(this).find(".redux-typography-family").select2(b),b.data=null,e(this).find(".redux-typography-family").val(_).trigger("change");var j=i.find(".redux-typography-family");j.hasClass("redux-typography-family")||(m=e(this).find(".redux-typography-align").attr("placeholder"),b.placeholder=m,i.find(".redux-typography-style").select2(b)),m=e(this).find(".redux-typography-align").attr("placeholder"),b.placeholder=m,e(this).find(".redux-typography-align").select2(b),m=e(this).find(".redux-typography-family-backup").attr("placeholder"),b.placeholder=m,e(this).find(".redux-typography-family-backup").select2(b),m=e(this).find(".redux-typography-transform").attr("placeholder"),b.placeholder=m,e(this).find(".redux-typography-transform").select2(b),m=e(this).find(".redux-typography-font-variant").attr("placeholder"),b.placeholder=m,e(this).find(".redux-typography-font-variant").select2(b),m=e(this).find(".redux-typography-decoration").attr("placeholder"),b.placeholder=m,e(this).find(".redux-typography-decoration").select2(b),redux.field_objects.typography.select(a,!0,!1,null,!0),e(this).find(".redux-typography-family, .redux-typography-family-backup, .redux-typography-style, .redux-typography-subsets, .redux-typography-align").on("change",function(r){var i=e(this).attr("id");if(e(this).hasClass("redux-typography-family")){if(e("#"+i).val()){var l,a=e(this).select2("data");l=a?a[0].text:null;e("#"+i);e("#"+i).attr("data-value",l),t=a[0],s=!0,redux.field_objects.typography.select(e("#"+i),!0,!1,l,!0)}}else{var r=e("#"+i).val();e("#"+i).attr("data-value",r),(e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&(e("#"+i+' option[selected="selected"]').removeAttr("selected"),e("#"+i+' option[value="'+r+'"]').attr("selected","selected")),e(this).hasClass("redux-typography-subsets")&&e("#"+i).siblings(".typography-subsets").val(r),redux.field_objects.typography.select(e(this),!0,!1,null,!1)}}),e(this).find(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter").keyup(function(){redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}),e(this).find(".redux-typography-color").wpColorPicker({change:function(t,s){e(this).val(s.color.toString()),redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}}),e(this).find(".redux-typography-size").numeric({allowMinus:!1}),e(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0}),e(this).find(".redux-typography").on("select2:unselecting",function(t,s){var r=e(this).attr("id");e("#"+r).attr("data-value",""),e(this).hasClass("redux-typography-family")?(e(this).val(null).trigger("change"),redux.field_objects.typography.select(e("#"+r),!0,!1,null,!0)):((e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&e("#"+r+' option[selected="selected"]').removeAttr("selected"),e(this).hasClass("redux-typography-subsets")&&e("#"+r).siblings(".typography-subsets").val(""),e(this).hasClass("redux-typography-family-backup")&&e("#"+r).val(null).trigger("change"),redux.field_objects.typography.select(e(this),!0,!1,null,!1))}),window.onbeforeunload=null})})}})},redux.field_objects.typography.size=function(e){var s,t=0;for(s in e)e.hasOwnProperty(s)&&t++;return t},redux.field_objects.typography.makeBool=function(e){return"false"==e||"0"==e||e===!1||0===e?!1:"true"==e||"1"==e||e===!0||1==e?!0:void 0},redux.field_objects.typography.contrastColour=function(e){var t="#444444";if(""!==e){e=e.replace("#","");var s=parseInt(e.substr(0,2),16),r=parseInt(e.substr(2,2),16),i=parseInt(e.substr(4,2),16),a=(299*s+587*r+114*i)/1e3;t=a>=128?"#444444":"#ffffff"}return t},redux.field_objects.typography.select=function(i,a,l,o,d){var n;n=e(i).parents(".redux-container-typography:first").attr("data-id"),void 0===n&&(n=e(i).attr("data-id"));var u=(e(i).parents(".redux-container-typography:first"),e("#"+n+"-family").val());u||(u=null),o&&(u=o);var h=e("#"+n+" select.redux-typography-family-backup").val(),f=e("#"+n+" .redux-typography-size").val(),y=e("#"+n+" .redux-typography-height").val(),g=e("#"+n+" .redux-typography-word").val(),x=e("#"+n+" .redux-typography-letter").val(),v=e("#"+n+" select.redux-typography-align").val(),b=e("#"+n+" select.redux-typography-transform").val(),m=e("#"+n+" select.redux-typography-font-variant").val(),_=e("#"+n+" select.redux-typography-decoration").val(),j=e("#"+n+" select.redux-typography-style").val(),C=e("#"+n+" select.redux-typography-subsets").val(),w=e("#"+n+" .redux-typography-color").val(),O=e("#"+n).data("units");if(d){var S;s===!0?(S=redux.field_objects.typography.makeBool(t["data-google"]),e("#"+n+" .redux-typography-google-font").val(S)):S=redux.field_objects.typography.makeBool(e("#"+n+" .redux-typography-google-font").val()),e("#"+n).hasClass("typography-initialized")||(j=e("#"+n+" select.redux-typography-style").attr("data-value"),C=e("#"+n+" select.redux-typography-subsets").attr("data-value"),""!==j&&(j=String(j)),void 0!==typeof C&&(C=String(C))),void 0===redux.fonts.google&&(S=!1);var I="";S===!0&&u in redux.fonts.google?(I=redux.fonts.google[u],console.log("details "+I)):I={400:"Normal 400",700:"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"},e(i).hasClass("redux-typography-subsets")&&e("#"+n+" input.typography-subsets").val(C)}if(e(i).hasClass("redux-typography-family")){var k='<option value=""></option>';if(S===!0){var z="";e.each(I.variants,function(e,t){t.id===j||1===redux.field_objects.typography.size(I.variants)?(z=' selected="selected"',j=t.id):z="",k+='<option value="'+t.id+'"'+z+">"+t.name.replace(/\+/g," ")+"</option>"}),l&&e("#"+n+" .redux-typography-style").select2("destroy"),e("#"+n+" .redux-typography-style").html(k);var N=e("#"+n+" .redux-typography-style").attr("placeholder"),P=r;P.placeholder=N,e("#"+n+" .redux-typography-style").select2(P),P.placeholder=null,z="",k='<option value=""></option>',e.each(I.subsets,function(t,s){s.id===C||1===redux.field_objects.typography.size(I.subsets)?(z=' selected="selected"',C=s.id,e("#"+n+" input.typography-subsets").val(C)):z="",k+='<option value="'+s.id+'"'+z+">"+s.name.replace(/\+/g," ")+"</option>"}),l&&e("#"+n+" .redux-typography-subsets").select2("destroy"),e("#"+n+" .redux-typography-subsets").html(k),N=e("#"+n+" .redux-typography-subsets").attr("placeholder");var P=r;P.placeholder=N,e("#"+n+" .redux-typography-subsets").select2(P),P.placeholder=null,e("#"+n+" .redux-typography-subsets").parent().fadeIn("fast"),e("#"+n+" .typography-family-backup").fadeIn("fast")}else if(I){e.each(I,function(t,s){t===j||"normal"===t?(z=' selected="selected"',e("#"+n+" .typography-style select2-selection__rendered").text(s)):z="",k+='<option value="'+t+'"'+z+">"+s.replace("+"," ")+"</option>"}),l&&e("#"+n+" .redux-typography-style").select2("destroy"),e("#"+n+" .redux-typography-style").html(k),N=e("#"+n+" .redux-typography-style").attr("placeholder");var P=r;P.placeholder=N,e("#"+n+" .redux-typography-style").select2(P),P.placeholder=null,e("#"+n+" .redux-typography-subsets").parent().fadeOut("fast"),e("#"+n+" .typography-family-backup").fadeOut("fast")}e("#"+n+" .redux-typography-font-family").val(u)}else e(i).hasClass("redux-typography-family-backup")&&""!==h&&e("#"+n+" .redux-typography-font-family-backup").val(h);d&&(0===e("#"+n+" select.redux-typography-style option[value='"+j+"']").length?(j="",e("#"+n+" select.redux-typography-style").val("").trigger("change")):"400"===j&&e("#"+n+" select.redux-typography-style").val(j).trigger("change"),0===e("#"+n+" select.redux-typography-subsets option[value='"+C+"']").length&&(C="",e("#"+n+" select.redux-typography-subsets").val("").trigger("change"),e("#"+n+" input.typography-subsets").val(C)));var J="style_link_"+n;if(e("."+J).remove(),null!==u&&"inherit"!==u&&e("#"+n).hasClass("typography-initialized")){var Q=u.replace(/\s+/g,"+");if(S===!0){var M=Q;j&&""!==j&&(M+=":"+j.replace(/\-/g," ")),C&&""!==C&&(M+="&subset="+C),s===!1&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[M]}}),e("#"+n+" .redux-typography-google").val(!0)}else e("#"+n+" .redux-typography-google").val(!1)}if(-1!==j.indexOf("italic")?(e("#"+n+" .typography-preview").css("font-style","italic"),e("#"+n+" .typography-font-style").val("italic"),j=j.replace("italic","")):(e("#"+n+" .typography-preview").css("font-style","normal"),e("#"+n+" .typography-font-style").val("")),e("#"+n+" .typography-font-weight").val(j),y||(y=f),""===f||void 0===f?e("#"+n+" .typography-font-size").val(""):e("#"+n+" .typography-font-size").val(f+O),""===y||void 0===y?e("#"+n+" .typography-line-height").val(""):e("#"+n+" .typography-line-height").val(y+O),""===g||void 0===g?e("#"+n+" .typography-word-spacing").val(""):e("#"+n+" .typography-word-spacing").val(g+O),""===x||void 0===x?e("#"+n+" .typography-letter-spacing").val(""):e("#"+n+" .typography-letter-spacing").val(x+O),e("#"+n).hasClass("typography-initialized")){var B=e("#"+n+" .typography-preview").data("preview-size");"0"==B&&e("#"+n+" .typography-preview").css("font-size",f+O),e("#"+n+" .typography-preview").css("font-weight",j),e("#"+n+" .typography-preview").css("font-family",u+", sans-serif"),"none"===u&&""===u&&e("#"+n+" .typography-preview").css("font-family","inherit"),e("#"+n+" .typography-preview").css("line-height",y+O),e("#"+n+" .typography-preview").css("word-spacing",g+O),e("#"+n+" .typography-preview").css("letter-spacing",x+O),w&&(e("#"+n+" .typography-preview").css("color",w),e("#"+n+" .typography-preview").css("background-color",redux.field_objects.typography.contrastColour(w))),e("#"+n+" .typography-style select2-selection__rendered").text(e("#"+n+" .redux-typography-style option:selected").text()),e("#"+n+" .typography-script select2-selection__rendered").text(e("#"+n+" .redux-typography-subsets option:selected").text()),v&&e("#"+n+" .typography-preview").css("text-align",v),b&&e("#"+n+" .typography-preview").css("text-transform",b),m&&e("#"+n+" .typography-preview").css("font-variant",m),_&&e("#"+n+" .typography-preview").css("text-decoration",_),e("#"+n+" .typography-preview").slideDown()}e("#"+n).hasClass("typography-initialized")||e("#"+n).addClass("typography-initialized"),s=!1,a||redux_change(i)}}(jQuery);