!function(e){"use strict";e.fn.extend({select2SortableOrder:function(){var t,r,a,o,i,p,s,y;return t=this.filter("[multiple]"),t.each(function(){return r=e(this),"object"!=typeof r.data("select2")?!1:(a=r.siblings(".select2-container"),i=[],r.find("optgroup").each(function(e,t){i.push(t)}),r.find("option").each(function(t,r){p=e(this).parent("optgroup").prop("label"),s=this,void 0===p&&(""===this.value||this.selected||i.push(s))}),o=e(a.find('.select2-selection__rendered li[class!="select2-search__field"]').map(function(){return this&&void 0!==e(this).data("data")?(y=e(this).data("data").id,r.find('option[value="'+y+'"]')[0]):void 0})),o.push.apply(o,i),r.children().remove(),void r.append(o))}),t},select2Sortable:function(){var t,r,a,o,i,p,s;if(t=Array.prototype.slice.call(arguments,0),r=this.filter("[multiple]"),a=["destroy"],0===t.length||"object"==typeof t[0])o={bindOrder:"formSubmit",sortableOptions:{placeholder:"ui-state-highlight",items:"li:not(.select2-search__field)",tolerance:"pointer"}},i=e.extend(o,t[0]),"object"!=typeof r.data("select2")&&r.select2(),r.each(function(){switch(p=e(this),s=p.siblings(".select2-container").find(".select2-selection__rendered"),s.sortable(i.sortableOptions),i.bindOrder){case"sortableStop":s.on("sortstop.select2sortable",function(e,t){p.select2SortableOrder()}),p.on("change",function(t){e(this).select2SortableOrder()});break;default:p.closest("form").unbind("submit.select2sortable").on("submit.select2sortable",function(){p.select2SortableOrder()})}});else{if(-1===e.inArray(t[0],a))throw"Unknown method: "+t[0];"destroy"===t[0]&&r.select2SortableDestroy()}return r},select2SortableDestroy:function(){var t,r,a;return t=this.filter("[multiple]"),t.each(function(){r=e(this),a=r.parent().find(".select2-selection__rendered"),r.closest("form").unbind("submit.select2sortable"),a.unbind("sortstop.select2sortable"),a.sortable("destroy")}),t}})}(jQuery);